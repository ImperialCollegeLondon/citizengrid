window.CVM={version:"2.0.12"};(function(I){var J="data:image/gif;base64,R0lGODlhIAAgALMAAGZmZnl5eczMzJ+fn////7Ozs4yMjGtra+Li4nFxcaampgAAAAAAAAAAAAAAAAAAACH5BAEHAAQALAAAAAAgACAAAASjkMhJq704681JKV04JYkYDgAwmBuSpgibGS9gyJdQpwJeBTtAwDcpBFMgYuJ1WKZKPlRqSACmVjLXK2l8xVi0raSbupl0Ne6uJ7K+zOEXtUOWS9zijrNGxT87UjtURyothAASh18YcUGJhGY5hzZ7R2wWfpNHcxR1lmiHSRSVQQoSCpNQE4GQEo1HWARamgcHmjCut7pvBKC7ugKZv4ecRMYsEQA7";var M="data:image/gif;base64,R0lGODlhIAAgAMQAAGZmZnt7e8TExK2treXl5dXV1Wtra4qKivj4+L29vd7e3pGRke/v78zMzLW1tYSEhHR0dJmZmQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEHAAgALAAAAAAgACAAAAXUICKOZGmeKMoUguMIBZPOY3IAeI4fCX0KEJ0wBxH4RouhMrfwEQLLKCBAmEGl0UAqmRUQBsumSYBtjG5KYykoVYwiS0gpgQUsZAVp71zHsaMHIwx9hAAyCHmACQoEDn9RBSJkSweMI5NSag51VSJ1DiKbWJ0In5JYBiOJmSKrYSNgWJEIg3ojV1KHCGhLnbVSgTVRciINdXsjjzpaxVjEJJhDbiIKCrhCaiVcQwEJBAoJD68o14VTM0/mOFQ+231iR0B1RUdzvEI89SosLjC6+gBnhAAAOw==";var x="data:image/gif;base64,R0lGODlhIAAgALMAAGZmZpOTk93d3Wtra8zMzLW1tXNzc3p6eu/v78XFxYODg9bW1qWlpejo6Pj4+IqKiiH5BAEHAA4ALAAAAAAgACAAAATr0MlJq7046827p4QBGMTHicBoVohApTAlIN4yjE1TwGmRH4DBooMa3XipQXFA0wiQ0ChguAHyFCUJQYE8dBqogY8BPDB0R0Pje0zYkMJEcs3ZAQKII7zx6GlCPAsMKQcuC1YMBDwkF0UpDih0DgspBghIBhdQDjcDEgEOl0EOmxaOAJApLlqVojCZFoeBgwAHQ4AAiTy2GnZ4p619AAUdeSlupwYLckFNG2BJBQgMIgYMCAVpkhpWMFg0CFuYHE9S5lMnr3o8SjBM5DcHDdhI0g1AQh+rEkgyziupKgHMsKAalYEIEypcyHBDBAA7";var v="data:image/gif;base64,R0lGODlhIAAgANUAAPX19fT09PLy8vDw8O7u7uzs7OLi4tnZ2c/Pz83NzczMzMXFxby8vLKysqmpqZ+fn5iYmJWVlZKSkoyMjICAgHx8fHl5eXZ2dnR0dHBwcG9vb21tbWtra2pqamhoaGdnZ2ZmZkxMTEpKSv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEHACMALAAAAAAgACAAAAauwJFwSCwaj8ikcln5OJ/QqFRKnFqv0OpnyR05tV3mdvgNC87GslCtFbnf7/R4PTfLwfYjm41I+P+AgYB7cyAZG4iJiouIdHh5RYSQd2R1Sg0RDwwAkXV8R5iGoguPXpZGDKKqIAeVpXqrqq6zSbGyjrSgtqO4vbq7rL5Ylbumhm0eycoSQ6GxfYqQD8+TqNMTDgXV23nY0A3cyMHhdBqG4OSmBgvj5BEGQgvo6WFBADs=";var A=null,u=false,w=[];I.debugLogging=true;I.markPageLoaded=function(){u=true};var z=function(S,Q){var O=800,V=600,R=24;if(Q!=undefined){var W=Q.split("x");O=parseInt(W[0]);V=parseInt(W[1]);if(W.length>2){R=parseInt(W[2])}}var P=(screen.width-O)/2,T=(screen.height-(V+100))/2;var U=window.open("http://cernvm.cern.ch/releases/webapi/webrdp/webclient.html#"+S+","+O+","+V,"WebRDPClient","width="+O+",height="+(V+100),",left="+P+",top="+T);U.focus();return U};I.startCVMWebAPI=function(R,Q,O){var P=function(){var S=new G();S.connect(function(T){if(T){R(S)}else{var U=document.createElement("iframe");U.src="http://cernvm.cern.ch/releases/webapi/install";U.width="100%";U.height=400;U.frameBorder=0;p.createFramedWindow({body:U,icon:x,disposable:false});var V=function(){S=new G();S.connect(function(W){if(W){R(S);p.hideInteraction()}else{setTimeout(function(){V()},1000)}},false)};V()}})};if(!u){w.push(P)}else{P()}};var l=0;var B=1;var g="ws://127.0.0.1:5624",D="cernvm-webapi://launch",o="http://127.0.0.1:5624/info";var K=1,q=2,L=4,m=8,C=16;var h=1,H=2,t=256;var E=1;function b(P){var O=["missing","available","poweroff","saved","paused","running"];if((P<0)||(P>=O.length)){return"unknown"}return O[P]}function c(T,S){var R=T.split("."),P=R[2]+R[1]*100+R[0]*10000,Q=S.split("."),O=Q[2]+Q[1]*100+Q[0]*10000;return P-O}var n="cernvm-webapi-launcher-"+(Math.random().toString().substr(2));var F=function(O){this.events={}};var i=F.prototype;i.__fire=function(P,O){if(I.debugLogging){console.log("Firing",P,"(",O,")")}if(this.events[P]==undefined){return}var R=this.events[P];for(var Q=0;Q<R.length;Q++){R[Q].apply(this,O)}};i.addEventListener=function(O,P){if(this.events[O]==undefined){this.events[O]=[]}this.events[O].push(P)};i.removeEventListener=function(O,Q){if(this.events[O]==undefined){return}var P=this.events[O].indexOf(Q);if(P<0){return}this.events.splice(P,1)};var N=function(P){var O=0;if(P.use64bit){O|=K}if(P.useBootDisk){O|=q}if(P.useGuestAdditions){O|=L}if(P.useFloppyIO){O|=m}if(P.headful){O|=C}return O};var d=function(Q){var O=function(R){Q.__config.flags=R;Q.setAsync("flags",R)},P=function(){return Q.__config.flags};Object.defineProperties(this,{value:{get:function(){return P()},set:function(R){O(R)}},use64bit:{get:function(){return((P()&K)!=0)},set:function(R){if(R){O(P()|K)}else{O(P()&~K)}}},useBootDisk:{get:function(){return((P()&q)!=0)},set:function(R){if(R){O(P()|q)}else{O(P()&~q)}}},useGuestAdditions:{get:function(){return((P()&L)!=0)},set:function(R){if(R){O(P()|L)}else{O(P()&~L)}}},useFloppyIO:{get:function(){return((P()&m)!=0)},set:function(R){if(R){O(P()|m)}else{O(P()&~m)}}},headful:{get:function(){return((P()&C)!=0)},set:function(R){if(R){O(P()|C)}else{O(P()&~C)}}}})};var k=function(){};var r=function(){F.call(this);this.interaction=new p(this);this.connecting=false;this.connected=false;this.socket=null;this.lastID=0;this.responseCallbacks={};this.authToken="";if(window.location.hash){this.authToken=window.location.hash.substr(1)}};r.prototype=Object.create(F.prototype);var y=r.prototype;y.__reheat=function(O){};y.__handleClose=function(){this.__fire("disconnected",[]);p.hideInteraction()};y.__handleOpen=function(O){this.__fire("connected",O.version)};y.__handleData=function(P){var Q=JSON.parse(P);if(Q.id){var O=this.responseCallbacks[Q.id];if(O!=undefined){O(Q)}}else{if(Q.type=="event"){var P=Q.data;if(Q.name=="interact"){this.interaction.handleInteractionEvent(Q.data)}else{this.__fire(Q.name,Q.data)}}}};y.send=function(Q,R,T,S){var V=this;var U=null;var W="a-"+(++this.lastID);var O={type:"action",name:Q,id:W,data:R||{}};if(typeof(T)=="function"){if(S!==0){U=setTimeout(function(){delete V.responseCallbacks[W];T(null,"Response timeout")},S||10000)}this.responseCallbacks[W]=function(X){if(U!=null){clearTimeout(U)}if(X.type=="result"){delete V.responseCallbacks[W];T(X.data)}}}else{if(typeof(T)=="object"){var P=function(X){if(!X){return""}return"on"+X[0].toUpperCase()+X.substr(1)};if(S!==0){U=setTimeout(function(){delete V.responseCallbacks[W];if(T.onError){T.onError("Response timeout")}},S||10000)}this.responseCallbacks[W]=function(Y){if(U!=null){clearTimeout(U)}if((Y.name=="succeed")||(Y.name=="failed")){delete V.responseCallbacks[W]}var X=P(Y.name);if(T[X]){T[X].apply(V,Y.data||[])}}}}this.socket.send(JSON.stringify(O))};y.close=function(){if(!this.connected){return}this.socket.close();this.connected=false;this.__handleClose()};y.connect=function(O,P){var X=this;if(this.connected){return}if(P==undefined){P=false}if(this.connecting){return}this.connecting=true;var W=function(Y){f.request(o,function(aa,Z){if(aa==null){Y(false)}else{Y(true)}})};var V=function(Y,ab){try{if(!ab){ab=500}var aa=false,ad=setTimeout(function(){aa=true;Y(false)},ab);var Z=new WebSocket(g);Z.onerror=function(ae){if(aa){return}clearTimeout(ad);if(!X.connecting){return}Z.close();Y(false)};Z.onopen=function(ae){if(aa){return}clearTimeout(ad);if(!X.connecting){return}Y(true,Z)}}catch(ac){console.warn("[socket] Error setting up socket! ",ac);if(aa){return}clearTimeout(ad);if(!X.connecting){return}Z.close();Y(false)}};var S=function(ac,ae,ah,Z){var aa=new Date().getTime();if(!Z){Z=aa}if(!ah){ah=500}var Y=ae-(aa-Z);var ab=false,af=setTimeout(function(){ab=true;ac(false)},Y);var ag=function(aj,ai){if(ab){return}if(aj){clearTimeout(af);ac(true,ai)}else{if(Y<ah){return}clearTimeout(af);setTimeout(function(){S(ac,ae,ah,Z)},ah)}};var ad=500;if(Y<ad){ad=Y}V(ag,ad)};var R=function(Y,Z){X.connecting=false;X.connected=true;X.socket=Y;X.socket.onclose=function(){console.warn("Socket disconnected");p.hideInteraction();X.connecting=true;S(function(ab,aa){if(!ab){console.error("Connection with CernVM WebAPI interrupted");X.__handleClose()}else{R(aa,true)}},2000)};X.socket.onmessage=function(aa){X.__handleData(aa.data)};X.send("handshake",{version:I.version,auth:X.authToken},function(ac,ab,aa){console.info("Successful handshake with CernVM WebAPI v"+ac.version);X.version=ac.version;if(c(I.version,X.version)>0){p.alertUpgrade("You are using an old version of CernVM WebAPI. Click here to upgrade to <strong>"+I.version+"</strong>.")}X.__handleOpen(ac);if(Z){X.__reheat(Y)}});if(O){O(true)}};var U=function(Y){console.error("Unable to contact CernVM WebAPI");if(!X.connecting){return}X.connecting=false;X.connected=false;if(O){O(false)}};var T=function(Z,Y){if(!Z){U()}else{R(Y)}};var Q=function(aa,Y,ad){var ac=1,ab=function(){if(++ac>Y){console.log("[socket] Ran out of retries");ad(false);return}else{console.log("[socket] Scheduling retry in 100ms");setTimeout(Z,100)}},Z=function(){console.log("[socket] Probe try");W(function(ae){if(ae){V(function(ag,af){if(ag){ad(ag,af)}else{ab()}},aa)}else{ab()}})};console.log("[socket] Trying socket probe with ",Y," retries");Z()};console.log("[socket] Starting probe with 4 retries");Q(500,4,function(Z,Y){if(Z){console.log("[socket] Got socket");R(Y)}else{if(P){console.log("[socket] Auto-launching");var aa=document.getElementById(n);if(!aa){aa=document.createElement("iframe");aa.style.width="1";aa.style.height="1";aa.style.position="absolute";aa.style.left="-1000px";aa.style.top="-1000px";aa.id=n;document.body.appendChild(aa)}var aa=document.getElementById(n);aa.src=D;S(T,5000)}else{U()}}})};var j=null;var p=function(O){var P=this;this.socket=O;this.onResize=null;window.addEventListener("resize",function(){if(P.onResize){P.onResize()}})};p.hideScreen=function(P){try{document.body.removeChild(P)}catch(O){}};p.hideInteraction=function(){if(p.activeScreen!=null){try{document.body.removeChild(p.activeScreen)}catch(O){}p.activeScreen=null}};p.createButton=function(R,S){var P=document.createElement("button");P.innerHTML=R;P.style.display="inline-block";P.style.marginBottom="0";P.style.textAlign="center";P.style.verticalAlign="middle";P.style.borderStyle="solid";P.style.borderWidth="1px";P.style.borderRadius=P.style.webkitBorderRadius=P.style.mozBorderRadius="4px";P.style.userSelect=P.style.webkitUserSelect=P.style.mozUserSelect=P.style.msUserSelect="none";P.style.margin="5px";P.style.padding="6px 12px";P.style.cursor="pointer";var O=function(T,X){var U=parseInt(T.slice(1),16),Z=Math.round(2.55*X),W=(U>>16)+Z,V=(U>>8&255)+Z,Y=(U&255)+Z;return"#"+(16777216+(W<255?W<1?0:W:255)*65536+(V<255?V<1?0:V:255)*256+(Y<255?Y<1?0:Y:255)).toString(16).slice(1)},Q=function(X){var U=parseInt(X.slice(1),16),W=(U>>16),V=(U>>8&255),T=(U&255),Y=(W*299+V*587+T*114)/1000;return(Y>=128)?"black":"white"};P.style.backgroundColor=S;P.style.borderColor=O(S,-20);P.onmouseover=function(){P.style.backgroundColor=O(S,-10)};P.onmouseout=function(){P.style.backgroundColor=S};P.style.color=Q(S);return P};p.styleFrame=function(O){O.style.backgroundColor="#FCFCFC";O.style.border="solid 1px #E6E6E6";O.style.borderRadius=O.style.webkitBorderRadius=O.style.mozBorderRadius="5px";O.style.boxShadow=O.style.webkitBoxShadow=O.style.mozBoxShadow="1px 2px 4px 1px rgba(0,0,0,0.2)";O.style.padding="10px";O.style.fontFamily="Verdana, Geneva, sans-serif";O.style.fontSize="14px";O.style.color="#666"};p.createGrowlWindow=function(P){if(!P){P={}}var R=P.body||"",O=P.href||"",U=P.target||"",W=P.icon||false,S=P.onClick||false;var Q=document.createElement("a"),V=document.createElement("img"),T=document.createElement("div");Q.appendChild(V);V.style.position="absolute";V.style.left="6px";V.style.top="12px";V.src=W||J;Q.appendChild(T);T.style.position="absolute";T.style.left="45px";T.style.top="8px";T.style.width="300px";T.style.height="42px";T.style.fontSize="14px";T.style.color="#333";T.innerHTML=R;Q.style.position="absolute";Q.style.display="block";Q.style.top="10px";Q.style.right="10px";Q.style.zIndex=60000;Q.style.width="350px";Q.style.height="60px";Q.style.backgroundImage=x;Q.style.backgroundPosition="bottom left";Q.style.textDecoration="none";Q.href=O;Q.target=U;p.styleFrame(Q);Q.onclick=function(){document.body.removeChild(Q);if(S){S()}};document.body.appendChild(Q);return Q};p.createFramedWindow=function(Q){if(!Q){Q={}}var T=Q.body||"",S=Q.header||false,ac=Q.footer||false,aa=Q.icon||false,V=Q.onClose||false,Z=(Q.disposable!=undefined)?Q.disposable:true;var Y=document.createElement("div"),X=document.createElement("div"),P=document.createElement("div"),U=document.createElement("div"),R=document.createElement("div");Y.style.position="absolute";Y.style.left="0";Y.style.top="0";Y.style.right="0";Y.style.bottom="0";Y.style.zIndex=60000;Y.style.backgroundColor="rgba(255,255,255,0.5)";Y.appendChild(X);X.style.marginLeft="auto";X.style.marginRight="auto";X.style.marginBottom=0;X.style.marginTop=0;p.styleFrame(X);X.style.width="70%";P.style.color="#333";P.style.marginBottom="8px";U.style.textAlign="center";U.style.color="#333";U.style.marginTop="8px";X.appendChild(P);if(S){if(typeof(S)=="string"){var W;if(aa){W=document.createElement("img");W.src=aa;W.style.verticalAlign="-8px";W.style.marginRight="6px"}else{W=document.createElement("span")}var O=document.createElement("span");O.innerHTML=S;O.style.fontSize="1.6em";O.style.marginBottom="8px";P.appendChild(W);P.appendChild(O)}else{P.appendChild(S)}}if(T){R.style.overflow="auto";R.appendChild(T)}X.appendChild(R);X.appendChild(U);if(ac){if(typeof(ac)=="string"){U.innerHTML=ac}else{U.appendChild(ac)}}var ab=function(){var ad=P.offsetHeight+U.offsetHeight+50;var af=window.innerHeight-ad;R.style.maxHeight=af+"px";var ae=(window.innerHeight-X.offsetHeight)/2;if(ae<0){ae=0}X.style.marginTop=ae+"px"};Y.onclick=function(){if(!Z){return}if(V){V()}else{p.hideInteraction()}};X.onclick=function(ad){ad.stopPropagation()};p.hideInteraction();document.body.appendChild(Y);p.activeScreen=Y;ab();this.onResize=ab;return Y};p.displayLicenseWindow=function(W,T,R,V,Q){var S=document.createElement("div"),X=document.createElement("span"),P;X.innerHTML="&nbsp;";if(R){P=document.createElement("iframe"),P.src=T;P.width="100%";P.height=450;P.frameBorder=0}else{P=document.createElement("div");P.width="100%";P.style.height="450px";P.style.display="block";P.innerHTML=T.replace(/\n/g,"<br/>\n")}var O=p.createButton("Accept License","#E1E1E1");lnkCancel=p.createButton("Decline License","#FAFAFA");S.style.padding="6px";S.appendChild(O);S.appendChild(X);S.appendChild(lnkCancel);var U;U=p.createFramedWindow({body:P,header:W,footer:S,icon:v,onClose:function(){document.body.removeChild(U);if(Q){Q()}}});O.onclick=function(){document.body.removeChild(U);if(V){V()}};lnkCancel.onclick=function(){document.body.removeChild(U);if(Q){Q()}};return win};p.alertUpgrade=function(O,P){p.createGrowlWindow({body:O,icon:x,cbClick:P,target:"_blank",href:"http://cernvm.cern.ch/releases/webapi/install"})};p.confirm=function(T,O,V){var S=document.createElement("div"),U=document.createElement("div");S.innerHTML=O;S.style.width="100%";var R,Q=p.createButton("Ok","#E1E1E1"),P=p.createButton("Cancel","#FAFAFA");Q.onclick=function(){document.body.removeChild(R);V(true)};P.onclick=function(){document.body.removeChild(R);V(false)};U.appendChild(Q);U.appendChild(P);R=p.createFramedWindow({body:S,header:T,footer:U,icon:M,onClose:function(){document.body.removeChild(R);V(false)}});return R};p.alert=function(S,O,U){var R=document.createElement("div"),T=document.createElement("div");R.innerHTML=O;R.style.width="100%";var Q,P=p.createButton("Ok","#FAFAFA");P.onclick=function(){document.body.removeChild(Q)};T.appendChild(P);Q=p.createFramedWindow({body:R,header:S,footer:T,icon:J});return Q};p.occupied=function(R,O){var Q=document.createElement("div");Q.innerHTML=O;Q.style.width="100%";var P=p.createFramedWindow({body:Q,header:R,icon:x,disposable:false});return P};p.confirmLicense=function(P,O,Q){p.displayLicenseWindow(P,O,false,function(){Q(true)},function(){Q(false)})};p.confirmLicenseURL=function(P,O,Q){p.displayLicenseWindow(P,O,true,function(){Q(true)},function(){Q(false)})};p.controlOccupied=function(O,P){if(O){if(!j){j=p.occupied("Installation in progress","<p>Pay attention on the the pop-up windows and follow the on-screen instructions.</p><p>When completed, please close any open installation window in order to continue.</p>")}}else{if(j){p.hideScreen(j);j=null}}};p.prototype.handleInteractionEvent=function(P){var O=this.socket;if(P[0]=="confirm"){p.confirm(P[1],P[2],function(Q,R){if(Q){O.send("interactionCallback",{result:h|(R?t:0)})}else{O.send("interactionCallback",{result:H|(R?t:0)})}})}else{if(P[0]=="alert"){p.alert(P[1],P[2],function(Q){})}else{if(P[0]=="confirmLicense"){p.confirmLicense(P[1],P[2],function(Q,R){if(Q){O.send("interactionCallback",{result:h|(R?t:0)})}else{O.send("interactionCallback",{result:H|(R?t:0)})}})}else{if(P[0]=="confirmLicenseURL"){p.confirmLicenseURL(P[1],P[2],function(Q,R){if(Q){O.send("interactionCallback",{result:h|(R?t:0)})}else{O.send("interactionCallback",{result:H|(R?t:0)})}})}}}}};var f={XMLHttpFactories:[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new ActiveXObject("Msxml2.XMLHTTP.6.0")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],request:function(P,S,O){var Q=this.createXMLHTTPObject();if(!Q){return}var R=(O)?"POST":"GET";Q.open(R,P,true);if(O){Q.setRequestHeader("Content-type","application/x-www-form-urlencoded")}Q.onreadystatechange=function(){if(Q.readyState!=4){return}if(Q.status!=200&&Q.status!=304){S(null,Q.status);return}S(Q.responseText)};Q.ontimeout=function(){S(null,false)};if(Q.readyState==4){return}Q.send(O)},createXMLHTTPObject:function(){var P=false;for(var O=0;O<this.XMLHttpFactories.length;O++){try{P=this.XMLHttpFactories[O]()}catch(Q){continue}break}return P}};var G=function(){r.call(this);this._sessions=[]};G.prototype=Object.create(r.prototype);var s=G.prototype;s.__reheat=function(O){var P=this,R=false;this.responseCallbacks={};for(var Q=0;Q<this._sessions.length;Q++){var S=this._sessions[Q].ref,T=this._sessions[Q].vmcp;if(S.__valid){this.send("requestSession",{vmcp:T},{onSucceed:function(V,U){console.log("Session ",U," reheated");S.session_id=U;P.responseCallbacks[U]=function(W){S.handleEvent(W)};setTimeout(function(){S.sync()},100)},onFailed:function(V,U){console.warn("Unable to reheat a saved session!");if(R){return}P.__handleClose();R=true},onLengthyTask:function(V,U){p.controlOccupied(U,V)},onProgress:function(V,U){P.__fire("progress",[V,U])},onStarted:function(U){P.__fire("started",[U])},onCompleted:function(U){P.__fire("completed",[U])}})}}};s.stopService=function(){this.send("stopService")};s.requestSession=function(R,Q,P){var O=this;this.send("requestSession",{vmcp:R},{onSucceed:function(U,S){var T=new a(O,S,function(){if(Q){Q(T)}});O._sessions.push({vmcp:R,ref:T});O.responseCallbacks[S]=function(V){T.handleEvent(V)}},onFailed:function(T,S){console.error("Failed to request session! "+T);O.__fire("failed",[T]);if(P){P(T,S)}},onLengthyTask:function(T,S){p.controlOccupied(S,T)},onProgress:function(T,S){O.__fire("progress",[T,S])},onStarted:function(S){O.__fire("started",[S])},onCompleted:function(S){O.__fire("completed",[S])}})};s.enumSessions=function(P){var O=this;if(!P){return}this.send("enumSessions",{},{onSucceed:function(Q){P(Q)},onFailed:function(R,Q){P(null,R,Q)}})};s.controlSession=function(P,Q,R){var O=this;if(!R){return}this.send("controlSession",{session_id:P,action:Q},{onSucceed:function(S){R(S)},onFailed:function(T,S){R(null,T,S)}})};var a=function(O,Q,R){F.call(this);this.socket=O;this.session_id=Q;this.__state=0;this.__apiState=false;this.__properties={};this.__config={};this.__valid=true;this.__lastRDPWindow=null;this.__initCallback=R;var P=undefined;Object.defineProperties(this,{state:{get:function(){if(!this.__valid){return P}return this.__state}},stateName:{get:function(){if(!this.__valid){return P}return b(this.__state)}},ip:{get:function(){if(!this.__valid){return P}return this.__config.ip}},memory:{get:function(){if(!this.__valid){return P}return this.__config.memory}},cpus:{get:function(){if(!this.__valid){return P}return this.__config.cpus}},disk:{get:function(){if(!this.__valid){return P}return this.__config.disk}},apiURL:{get:function(){if(!this.__valid){return P}return this.__config.apiURL}},apiAvailable:{get:function(){if(!this.__valid){return P}return this.__apiState}},rdpURL:{get:function(){if(!this.__valid){return P}return this.__config.rdpURL}},executionCap:{get:function(){if(!this.__valid){return P}return this.__config.executionCap},set:function(S){this.__config.executionCap=S;this.setAsync("executionCap",S)}},version:{get:function(){if(!this.__valid){return P}return this.__config.cernvmVersion},set:function(S){if(!this.__valid){return}this.__config.cernvmVersion=S;this.setAsync("cernvmVersion",S)}},"flavor ":{get:function(){if(!this.__valid){return P}return this.__config.cernvmFlavor},set:function(S){if(!this.__valid){return}this.__config.cernvmFlavor=S;this.setAsync("cernvmFlavor",S)}},diskURL:{get:function(){if(!this.__valid){return P}return this.__config.diskURL},set:function(S){if(!this.__valid){return}this.__config.diskURL=S;this.setAsync("diskURL",S)}},diskChecksum:{get:function(){if(!this.__valid){return P}return this.__config.diskChecksum},set:function(S){if(!this.__valid){return}this.__config.diskChecksum=S;this.setAsync("diskChecksum",S)}},flags:{get:function(){if(!this.__valid){return P}return new d(this)},set:function(S){if(typeof(S)=="number"){this.__config.flags=S}else{if(typeof(S)=="object"){this.__config.flags=N(S)}}}}})};a.prototype=Object.create(F.prototype);var e=a.prototype;e.handleEvent=function(P){if(P.name=="stateVariables"){P=P.data;if(!P){return}else{if(P.length>=1){this.__config=P[0]||{}}if(P.length>=2){this.__properties=P[1]||{}}}if(this.__initCallback){this.__initCallback();this.__initCallback=null}return}else{if(P.name=="failure"){var O=P.data[0];if(O&E!=0){p.alert("Virtualization Failure",'<p>The hypervisor was unable to use your hardware\'s virtualization capabilities. This happens either if you have an old hardware (more than 4 years old) or if the <strong>Virtualization Technology</strong> features is disabled from your <strong>BIOS</strong>.</p><p>There are various articles on the internet on how to enable this option from your BIOS. <a target="_blank" href="http://www.sysprobs.com/disable-enable-virtualization-technology-bios">You can read this article for example.</a></p>')}}else{if(P.name=="stateChanged"){this.__state=P.data[0]}else{if(P.name=="lengthyTask"){p.controlOccupied(P.data[1],P.data[0])}else{if(P.name=="apiStateChanged"){this.__apiState=(P.data[0]==1)}else{if(P.name=="resolutionChanged"){if(this.__config.rdpURL!=undefined){var R=this.__config.rdpURL.split("@");this.__config.rdpURL=R[0]+"@"+P.data[0]+"x"+P.data[1]+"x"+P.data[2];if(this.__lastRDPWindow){try{this.__lastRDPWindow.resizeTo(parseInt(P.data[0]),parseInt(P.data[1]))}catch(Q){}}}}}}}}}this.__fire(P.name,P.data)};e.start=function(O){if(!this.__valid){return}this.socket.send("start",{session_id:this.session_id,parameters:O||{}})};e.stop=function(){if(!this.__valid){return}this.socket.send("stop",{session_id:this.session_id})};e.pause=function(){if(!this.__valid){return}this.socket.send("pause",{session_id:this.session_id})};e.resume=function(){if(!this.__valid){return}this.socket.send("resume",{session_id:this.session_id})};e.reset=function(){if(!this.__valid){return}this.socket.send("reset",{session_id:this.session_id})};e.hibernate=function(){if(!this.__valid){return}this.socket.send("hibernate",{session_id:this.session_id})};e.close=function(){this.socket.send("close",{session_id:this.session_id})};e.sync=function(){if(!this.__valid){return}this.socket.send("sync",{session_id:this.session_id})};e.getAsync=function(P,O){if(!this.__valid){return}this.socket.send("get",{session_id:this.session_id,key:P},{onSucceed:function(Q){if(O){O(Q)}}})};e.setAsync=function(Q,P,O){if(!this.__valid){return}this.socket.send("set",{session_id:this.session_id,key:Q,value:P},{onSucceed:function(){if(O){O()}}})};e.getProperty=function(O){if(!this.__valid){return}if(!O){return""}if(this.__properties[O]==undefined){return""}return this.__properties[O]};e.setProperty=function(O,P){if(!this.__valid){return}if(!O){return""}this.__properties[O]=P;this.socket.send("setProperty",{session_id:this.session_id,key:O,value:P})};e.openRDPWindow=function(R,O){if(!this.__valid){return}var P=this;if(this.__config.rdpURL){var Q=this.__config.rdpURL.split("@");this.__lastRDPWindow=z(Q[0],Q[1])}else{this.getAsync("rdpURL",function(T){var S=T.split("@");P.__lastRDPWindow=z(S[0],S[1])})}};if(window.jQuery==undefined){if(u){return}window.addEventListener("load",function(P){u=true;for(var O=0;O<w.length;O++){w[O]()}})}else{jQuery(function(){if(u){return}u=true;for(var O=0;O<w.length;O++){w[O]()}})}})(window.CVM);